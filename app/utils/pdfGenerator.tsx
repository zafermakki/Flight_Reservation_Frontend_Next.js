// app/utils/pdfGenerator.ts
import jsPDF from 'jspdf';
import autoTable from 'jspdf-autotable';
import { Booking } from '../(activities)/profile/page'; // ØªØ£ÙƒØ¯ Ø£Ù† Ù„Ø¯ÙŠÙƒ Ù†ÙØ³ Ø§Ù„Ù€ interface Ù‡Ù†Ø§

export const generateBookingPDF = (booking: Booking) => {
  const doc = new jsPDF();

  // ğŸ¨ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Teal-500
  const teal500: [number, number, number] = [20, 184, 166];

  // ğŸ›« Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø¹ ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ
  doc.setFontSize(26);
  doc.setTextColor(...teal500);
  doc.text('âœˆ Flight Reservation Ticket', 14, 20);

  // Ø®Ø· ÙØ§ØµÙ„
  doc.setDrawColor(...teal500);
  doc.setLineWidth(1);
  doc.line(14, 25, 196, 25);

  // ğŸ“ Ø¬Ø¯ÙˆÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø¬Ø²
  const bookingData = [
    ['Reservation ID', booking.id],
    ['Flight', booking.flight],
    ['Gender', booking.gender],
    ['Date of Birth', booking.date_of_birth || 'Not specified'],
    ['Nationality', booking.nationality || 'Not specified'],
    ['Email', booking.email],
    ['Phone Number', booking.phone_number || 'Not specified'],
    ['Seats Booked', booking.seats_booked],
    ['Travel Class', booking.travel_class],
    ['Booking Date', new Date(booking.booking_date).toLocaleString('en-US')],
  ];

  autoTable(doc, {
    startY: 32,
    head: [['Field', 'Details']],
    body: bookingData,
    theme: 'grid',
    headStyles: { 
      fillColor: teal500 as [number, number, number], 
      textColor: 255, 
      halign: 'center', 
      fontSize: 12 
    },
    bodyStyles: { fontSize: 11, valign: 'middle' },
    alternateRowStyles: { fillColor: [230, 255, 253] }, // Ø®Ù„ÙÙŠØ© ØµÙÙˆÙ Ø¨Ù„ÙˆÙ† ÙØ§ØªØ­
  });

  // ğŸ–‹ ØªÙˆÙ‚ÙŠØ¹ / Footer ÙŠØ´Ø¨Ù‡ Ø§Ù„ØªØ°ÙƒØ±Ø©
  const pageHeight = doc.internal.pageSize.height;
  doc.setFontSize(12);
  doc.setTextColor(...teal500);
  doc.text('Thank you for choosing our airline!', 14, pageHeight - 20);
  doc.setFontSize(10);
  doc.setTextColor(150);
  doc.text('Generated by My Flight Booking System', 14, pageHeight - 12);

  // ğŸ’¾ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
  doc.save(`booking_${booking.id}.pdf`);
};
